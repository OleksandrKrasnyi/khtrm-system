# Database Analysis Tools / Инструменты анализа базы данных

## Проблема с оригинальным bat-скриптом

Оригинальный скрипт `enhanced_dispatcher_analysis.bat` не работал из-за отсутствия MySQL клиента (`mysql.exe`) на удаленном сервере. Все команды возвращали ошибку:
```
'mysql' is not recognized as an internal or external command
```

## Решение: Python-скрипт для анализа БД

Создан новый Python-скрипт `enhanced_db_analysis.py`, который использует те же настройки подключения к БД, что и основное приложение.

### Особенности:

- ✅ Не требует установки MySQL клиента
- ✅ Использует настройки подключения из приложения
- ✅ Анализирует структуру таблиц
- ✅ Получает примеры данных
- ✅ Создает карту полей
- ✅ Генерирует рекомендации по улучшению

## Как использовать:

### Автоматический способ (рекомендуется):
```bash
# Запустите в папке scripts/
run_db_analysis.bat
```

Этот скрипт:
1. Проверит наличие Python
2. Установит зависимости (mysql-connector-python)
3. Запустит анализ БД
4. Сохранит результаты в папку `python_db_analysis`

### Ручной способ:
```bash
# 1. Установите зависимости
pip install mysql-connector-python

# 2. Запустите анализ
python enhanced_db_analysis.py
```

## Результаты анализа

После выполнения скрипта будет создана папка `python_db_analysis` с файлами:

- **`analysis_report.txt`** - Читаемый отчет с результатами анализа
- **`full_analysis.json`** - Полные данные в JSON формате для программной обработки

## Что анализируется:

1. **Структура таблицы `zanaradka`** - основная таблица нарядов
2. **Связанные таблицы** - `sprmarshrut`, `sprpersonal`, `sprpe`
3. **Значения полей** - анализ содержимого ключевых полей
4. **Примеры данных** - реальные записи из БД
5. **Карта полей** - соответствие между БД и веб-интерфейсом
6. **Рекомендации** - конкретные предложения по улучшению

## Обнаруженные проблемы:

### 1. Неправильные поля в backend:
- `putlist???` вместо `pe№` для номера ПС
- `putlist???` вместо `putlist№` для путевого листа

### 2. Проблемы с Simple View:
- Показывает только ФИО водителя
- Должен показывать: маршрут, смену, водителя, ПС, времена

### 3. Проблемы с кодировкой:
- Украинские имена могут отображаться неправильно

## Следующие шаги:

1. **Запустите анализ** с помощью `run_db_analysis.bat`
2. **Изучите результаты** в `python_db_analysis/analysis_report.txt`
3. **Сообщите о находках** разработчику
4. **Используйте рекомендации** для улучшения веб-интерфейса

## Требования:

- Python 3.8 или выше
- Доступ к интернету (для установки зависимостей)
- Доступ к базе данных на `91.222.248.216:61315`

## Поддержка:

Если у вас есть проблемы с запуском скрипта, проверьте:
1. Установлен ли Python (`python --version`)
2. Работает ли pip (`pip --version`)
3. Есть ли доступ к базе данных
4. Правильность настроек подключения в скрипте 
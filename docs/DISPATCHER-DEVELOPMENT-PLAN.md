# План разработки функционала нарядчика

## Цель
Заменить простое приветствие на странице нарядчика на полнофункциональную таблицу с нарядами и управлением ресурсами.

## Этапы разработки

### Этап 1: Подготовка API и модели данных (Backend)

#### 1.1 Создание моделей данных
- [ ] Создать модель `Assignment` (Наряд)
- [ ] Создать модель `Route` (Маршрут)  
- [ ] Создать модель `Employee` (Сотрудник)
- [ ] Создать модель `Vehicle` (Транспорт)

#### 1.2 Создание API роутеров
- [ ] Создать роутер `/api/assignments` для работы с нарядами
- [ ] Создать роутер `/api/routes` для справочника маршрутов
- [ ] Создать роутер `/api/employees` для справочника персонала
- [ ] Создать роутер `/api/vehicles` для справочника транспорта

#### 1.3 Основные API endpoints
- [ ] `GET /api/assignments` - получить наряды с фильтрацией
- [ ] `POST /api/assignments` - создать новый наряд
- [ ] `PUT /api/assignments/{id}` - обновить наряд
- [ ] `DELETE /api/assignments/{id}` - удалить наряд
- [ ] `GET /api/routes` - получить справочник маршрутов
- [ ] `GET /api/employees` - получить справочник сотрудников
- [ ] `GET /api/vehicles` - получить справочник транспорта

### Этап 2: Разработка фронтенда

#### 2.1 Создание TypeScript типов
- [ ] Создать интерфейсы для всех моделей данных
- [ ] Создать типы для API запросов/ответов

#### 2.2 Создание компонентов
- [ ] Компонент `AssignmentTable` - основная таблица нарядов
- [ ] Компонент `AssignmentFilters` - фильтры для таблицы
- [ ] Компонент `AssignmentForm` - форма создания/редактирования наряда
- [ ] Компонент `ResourceStats` - статистика ресурсов

#### 2.3 Создание API сервисов
- [ ] Создать сервис `assignmentService` для работы с нарядами
- [ ] Создать сервис `resourceService` для работы со справочниками

#### 2.4 Обновление страницы нарядчика
- [ ] Заменить компонент `Dashboard` для роли нарядчика
- [ ] Интегрировать все компоненты в единый интерфейс

### Этап 3: Тестирование и оптимизация

#### 3.1 Тестирование API
- [ ] Создать тесты для всех API endpoints
- [ ] Проверить валидацию данных
- [ ] Тестирование производительности запросов

#### 3.2 Тестирование UI
- [ ] Тестирование отображения данных
- [ ] Тестирование фильтрации
- [ ] Тестирование создания/редактирования нарядов

## Приоритетная последовательность

### Неделя 1: Основы
1. **День 1-2**: Создание моделей данных и основных API endpoints
2. **День 3-4**: Создание основной таблицы нарядов (чтение данных)
3. **День 5-7**: Добавление фильтрации и базового UI

### Неделя 2: Функциональность
1. **День 8-10**: Создание/редактирование нарядов
2. **День 11-12**: Интеграция справочников
3. **День 13-14**: Валидация и обработка ошибок

### Неделя 3: Доработка
1. **День 15-17**: Тестирование и исправление багов
2. **День 18-19**: Оптимизация производительности
3. **День 20-21**: Доработка UI/UX

## Технические требования

### Backend
- FastAPI роутеры с правильной структурой
- Pydantic модели для валидации данных
- Правильная обработка ошибок
- Логирование всех операций
- Поддержка пагинации для больших таблиц

### Frontend
- TypeScript для типизации
- Vue 3 Composition API
- Реактивные компоненты
- Обработка состояний загрузки
- Пользовательские уведомления об ошибках

### База данных
- Оптимизированные SQL запросы
- Использование индексов
- Транзакции для критичных операций
- Кеширование часто используемых данных

## Мокапы данных для разработки

Создан файл `backend/mock_data/dispatcher_data.json` с примерами данных для разработки и тестирования.

## Критерии готовности

### Минимальный функционал (MVP)
- [ ] Отображение списка нарядов на текущую дату
- [ ] Фильтрация по дате, маршруту, смене
- [ ] Создание нового наряда
- [ ] Редактирование существующего наряда

### Полный функционал
- [ ] Все CRUD операции с нарядами
- [ ] Управление справочниками
- [ ] Валидация бизнес-логики
- [ ] Отчеты и статистика
- [ ] Экспорт данных

## Следующие шаги

1. **Начать с создания моделей данных** в backend
2. **Создать базовый API endpoint** для получения нарядов
3. **Создать простую таблицу** на фронтенде для отображения данных
4. **Постепенно добавлять функциональность** 
# Анализ структуры MS Access таблицы диспетчера на дату 07.07.2025

## Данные из БД на 07.07.2025

### Примеры записей из таблицы `zanaradka`

**Запись 1:**
- ID: 830403
- Маршрут: 20
- Бригада: 1
- Смена: 4
- Водитель: Маркін Володимир Іванович
- Табельный номер: 3691
- Номер ПС: 1266
- Адрес заправки: Бочка
- Номер заправки: 50
- Время выхода: 06:02
- Время захода: 19:27
- Тип выпуска: ПP
- Конечная: Депо

**Запись 2:**
- ID: 830404
- Маршрут: 21
- Бригада: 1
- Смена: 4
- Водитель: Ткебучава Лері Михайлович
- Табельный номер: 5145
- Номер ПС: 1223
- Адрес заправки: Бочка
- Номер заправки: 50
- Время выхода: 06:25
- Время захода: 20:01
- Тип выпуска: ПP
- Конечная: Депо

**Запись 3:**
- ID: 830293
- Маршрут: 22
- Бригада: 1
- Смена: 1
- Водитель: Моргун Олександр Олексійович
- Табельный номер: 5218
- Номер ПС: 1391
- Адрес заправки: Бочка
- Конечная: Депо

## Структура таблицы `zanaradka` (47 полей)

### Основные поля для диспетчерской таблицы:

1. **marshrut** (smallint) - номер маршрута
2. **vipusk** (tinyint) - выпуск/бригада
3. **smena** (varchar) - смена
4. **tabvoditel** (int) - табельный номер водителя
5. **fiovoditel** (varchar) - ФИО водителя
6. **pe№** (int) - номер подвижного состава
7. **data_day** (date) - дата наряда
8. **tvih** (char) - время выхода
9. **tzah** (char) - время захода
10. **ZaprAdr** (varchar) - адрес заправки
11. **zaprv** (int) - номер заправки
12. **tipvipusk** (varchar) - тип выпуска
13. **kpvih** (varchar) - конечная остановка выхода
14. **tob1**, **tob2** (varchar) - перерывы 1 и 2
15. **putlist№** (varchar) - номер путевого листа

### Поля для расчета часов:
- **tPodgotovkaVod** - время подготовки водителя
- **tSda4aVod** - время сдачи водителя
- **tVihdepoVod** - время выхода из депо водителя
- **tZahdepoVod** - время захода в депо водителя

### Данные из таблицы `tabel` (78 полей)

Поля связанные с часами работы:
- **time_fakt_line** - фактическое время на линии
- **time_pr_depo** - время подготовки в депо
- **time_pr_line** - время подготовки на линии
- **time_pr_vod** - время подготовки водителя
- **time_noch** - ночное время
- **time_vech** - вечернее время
- **plan_chas** - плановые часы
- **timevih1**, **timevih2** - время выхода 1 и 2
- **timezah1**, **timezah2** - время захода 1 и 2

## Формирование MS Access таблицы

### Колонки MS Access (украинские заголовки):

1. **Мт** = marshrut (номер маршрута)
2. **Вп** = vipusk (выпуск/бригада)
3. **Зм** = smena (смена)
4. **Ро** = pe№ (номер подвижного состава)
5. **Запр.** = zaprv (номер заправки)
6. **Адреса** = ZaprAdr (адрес заправки)
7. **Тип** = tipvipusk (тип выпуска)
8. **№ в** = tabvoditel (табельный номер водителя)
9. **ПІБ вод.** = fiovoditel (ФИО водителя)
10. **ЧасП.** = расчетное поле (часы подготовки)
11. **ЧасР.** = расчетное поле (часы работы)
12. **ЧасП2** = расчетное поле (часы подготовки 2)
13. **ЧасР2** = расчетное поле (часы работы 2)
14. **П.В.** = tPodgotovkaVod (подготовка водителя)
15. **Взд** = tvih (время выхода)
16. **Ззд** = tzah (время захода)
17. **К.В.** = tSda4aVod (конец работы)
18. **Пер. 1** = tob1 (перерыв 1)
19. **Пер. 2** = tob2 (перерыв 2)
20. **П. від** = tVihdepoVod (выход из депо)
21. **К. від** = tZahdepoVod (заход в депо)
22. **М.явки** = mestootst (место отстоя)
23. **М. закін** = kpvih (конечная)
24. **М. відст** = kpzah (конечная захода)

## Особенности формирования данных

### Расчет часов:
- Часы рассчитываются на основе времени выхода/захода
- Используются данные из таблицы `tabel` для точных расчетов
- Время хранится в секундах и конвертируется в часы

### Кодировка:
- Украинские символы требуют правильной кодировки
- ФИО водителей отображаются на украинском языке

### Связи между таблицами:
- `zanaradka` - основная таблица нарядов
- `tabel` - таблица учета рабочего времени
- `sprmarshrut` - справочник маршрутов
- `sprpersonal` - справочник персонала
- `sprpe` - справочник подвижного состава

## Пример SQL запроса для формирования таблицы

```sql
SELECT 
    z.marshrut as 'Мт',
    z.vipusk as 'Вп', 
    z.smena as 'Зм',
    z.pe№ as 'Ро',
    z.zaprv as 'Запр.',
    z.ZaprAdr as 'Адреса',
    z.tipvipusk as 'Тип',
    z.tabvoditel as '№ в',
    z.fiovoditel as 'ПІБ вод.',
    -- Расчетные поля часов
    ROUND(t.time_fakt_line / 3600, 1) as 'ЧасП.',
    ROUND((TIMESTAMPDIFF(SECOND, z.tvih, z.tzah) / 3600), 1) as 'ЧасР.',
    z.tPodgotovkaVod as 'П.В.',
    z.tvih as 'Взд',
    z.tzah as 'Ззд',
    z.tSda4aVod as 'К.В.',
    z.tob1 as 'Пер. 1',
    z.tob2 as 'Пер. 2',
    z.tVihdepoVod as 'П. від',
    z.tZahdepoVod as 'К. від',
    z.mestootst as 'М.явки',
    z.kpvih as 'М. закін',
    z.kpzah as 'М. відст'
FROM zanaradka z
LEFT JOIN tabel t ON (t.tab = z.tabvoditel AND t.data_day = z.data_day)
WHERE z.data_day = '2025-07-07'
ORDER BY z.marshrut, z.smena;
```

## Вывод

Оригинальная таблица MS Access формируется путем объединения данных из нескольких таблиц:
- Основные данные из `zanaradka`
- Данные по часам из `tabel`
- Справочные данные из `sprmarshrut`, `sprpersonal`, `sprpe`

Для точного воспроизведения таблицы нужно правильно настроить:
1. Маппинг полей между БД и интерфейсом
2. Расчет часов работы
3. Кодировку украинских символов
4. Сортировку по маршруту и смене 